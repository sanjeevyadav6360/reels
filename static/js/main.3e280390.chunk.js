(this.webpackJsonpreel=this.webpackJsonpreel||[]).push([[0],{48:function(e){e.exports=JSON.parse('{"apiKey":"AIzaSyB37rbZG0auE7m4OpqPTo_3ndZKRdbSd-8","authDomain":"reels-f5eee.firebaseapp.com","projectId":"reels-f5eee","storageBucket":"reels-f5eee.appspot.com","messagingSenderId":"621349481743","appId":"1:621349481743:web:78cf1ffd3faf10246e627a"}')},60:function(e,t,n){},61:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var c=n(11),a=n(46),s=n.n(a),o=n(37),i=n(16),r=n(47),l=n(14),u=n(31),d=n(48);n(71),n(57),n(70);u.a.initializeApp(d);var j=new u.a.auth.GoogleAuthProvider,b=u.a.auth(),m=u.a.firestore(),p=u.a.storage(),f=(u.a,n(12)),h=Object(c.createContext)(),O=function(e){var t=Object(c.useState)(null),n=Object(l.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(!0),i=Object(l.a)(o,2),r=i[0],u=i[1];return Object(c.useEffect)((function(){var e=b.onAuthStateChanged((function(e){if(e){var t=e.displayName,n=e.email,c=e.uid,a=e.photoURL;s({displayName:t,email:n,uid:c,photoURL:a})}else s(null);u(!1)}));return function(){e()}}),[]),Object(f.jsx)(h.Provider,{value:a,children:!r&&e.children})},x=n(0),v=n.n(x),g=n(2),k=(n(60),function(e){var t,n=Object(c.useState)(!1),a=Object(l.a)(n,2),s=a[0],o=a[1],i=Object(c.useState)(!1),r=Object(l.a)(i,2),u=r[0],d=r[1],j=Object(c.useState)(""),b=Object(l.a)(j,2),p=b[0],O=b[1],x=Object(c.useState)([]),k=Object(l.a)(x,2),N=k[0],C=k[1],y=Object(c.useContext)(h);return y&&(t=e.data.likes.includes(y.uid)),Object(c.useEffect)((function(){var t=function(){var t=Object(g.a)(v.a.mark((function t(){var n,c,a,s;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.data.comments,c=[],a=0;case 3:if(!(a<n.length)){t.next=11;break}return t.next=6,m.collection("comments").doc(n[a]).get();case 6:s=t.sent,c.push(s.data());case 8:a++,t.next=3;break;case 11:C(c);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[e]),Object(f.jsxs)("div",{className:"video-card",children:[Object(f.jsx)("p",{className:"video-card-username",children:e.data.name}),Object(f.jsxs)("span",{className:"video-card-music",children:[Object(f.jsx)("span",{className:"material-icons",children:"music_note"}),Object(f.jsx)("marquee",{children:"some song"})]}),Object(f.jsx)("span",{onClick:function(e){d(!u)},className:"material-icons-outlined video-card-comment",children:"chat"}),Object(f.jsx)("span",{className:"material-icons-outlined video-card-like",onClick:function(){var n=e.data.likes;t?n=n.filter((function(e){return e!=y.uid})):n.push(y.uid),m.collection("posts").doc(e.data.id).update({likes:n})},children:t?"favorite":"favorite_border"}),u?Object(f.jsxs)("div",{className:"video-card-comment-box",children:[Object(f.jsx)("div",{className:"actual-comments",children:N.map((function(e){return Object(f.jsxs)("div",{className:"post-user-comment",children:[Object(f.jsx)("img",{src:e.photo}),Object(f.jsxs)("div",{children:[Object(f.jsx)("h5",{children:e.name}),Object(f.jsx)("p",{children:e.comment})]})]})}))}),Object(f.jsxs)("div",{className:"comment-form",children:[Object(f.jsx)("input",{type:"text",value:p,onChange:function(e){O(e.currentTarget.value)}}),Object(f.jsx)("button",{onClick:Object(g.a)(v.a.mark((function t(){var n,c,a,s,o;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.collection("comments").add({name:y.displayName,comment:p,photo:y.photoURL});case 2:return n=t.sent,O(""),t.next=6,n.get();case 6:return c=t.sent,a=c.id,t.next=10,m.collection("posts").doc(e.data.id).get();case 10:return s=t.sent,(o=s.data().comments).push(a),t.next=15,m.collection("posts").doc(e.data.id).update({comments:o});case 15:case"end":return t.stop()}}),t)}))),children:"Post"})]})]}):"",Object(f.jsx)("video",{onClick:function(e){s?(e.currentTarget.pause(),o(!1)):(e.currentTarget.play(),o(!0))},loop:!0,src:e.data.url,className:"video-card-video"})]})}),N=(n(61),function(){var e=Object(c.useContext)(h),t=Object(c.useState)([]),n=Object(l.a)(t,2),a=n[0],s=n[1];return Object(c.useEffect)((function(){var e=m.collection("posts").onSnapshot((function(e){for(var t=e.docs,n=[],c=0;c<t.length;c++)n.push(Object(r.a)({id:t[c].id},t[c].data()));s(n)}));return function(){e()}}),[]),Object(f.jsxs)(f.Fragment,{children:[e?"":Object(f.jsx)(i.a,{to:"/login"}),Object(f.jsx)("div",{className:"video-container",children:a.map((function(e){return Object(f.jsx)(k,{data:e},e.id)}))}),Object(f.jsx)("button",{className:"home-logout-btn",onClick:function(){b.signOut()},children:"Logout"}),Object(f.jsx)("input",{type:"file",onClick:function(e){e.currentTarget.value=null},onChange:function(t){var n=t.currentTarget.files[0],c=n.name,a=n.size,s=n.type;if((a/=1e6)>10)alert("file size exceeds 10mb");else if("video"===(s=s.split("/")[0])){var o=p.ref("/posts/".concat(e.uid,"/").concat(Date.now()+"-"+c)).put(n);o.on("state_changed",null,null,(function(){o.snapshot.ref.getDownloadURL().then((function(t){console.log(t),m.collection("posts").add({name:e.displayName,url:t,likes:[],comments:[]})}))}))}else alert("Please upload a video file")}})]})}),C=function(){var e=Object(c.useContext)(h);return Object(f.jsxs)(f.Fragment,{children:[e?Object(f.jsx)(i.a,{to:"/"}):"",Object(f.jsx)("button",{onClick:function(){b.signInWithPopup(j)},className:"btn btn-primary m-4",children:"Login with google"})]})};var y=function(){return Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(O,{children:Object(f.jsx)(o.a,{children:Object(f.jsxs)(i.d,{children:[Object(f.jsx)(i.b,{exact:!0,path:"/login",children:Object(f.jsx)(C,{})}),Object(f.jsx)(i.b,{exact:!0,path:"/",children:Object(f.jsx)(N,{})})]})})})})};s.a.render(Object(f.jsx)(y,{}),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.3e280390.chunk.js.map